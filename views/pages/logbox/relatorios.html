<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title><%= pageTitle %></title>
    <link
      href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="/static/css/logbox/style.css" />
    <link rel="stylesheet" href="/static/css/logbox/relatorios.css" />
  </head>
  <body>
    <div class="dashboard-container">
      <h1>
        <span class="material-icons">assessment</span>
        Gerador de Relatórios de Monitoramento
      </h1>

      <div class="report-filters">
        <div class="form-group">
          <label for="device-select">Selecione o Equipamento</label>
          <select id="device-select">
            <option value="all">Todos os Equipamentos</option>
            <% devices.forEach(device => { %>
            <option value="<%= device.id %>">
              <%= device.local_tag %> (SN: <%= device.serial_number %>)
            </option>
            <% }); %>
          </select>
        </div>
        <div class="form-group">
          <label for="start-date">Data de Início</label>
          <input type="datetime-local" id="start-date" />
        </div>
        <div class="form-group">
          <label for="end-date">Data de Fim</label>
          <input type="datetime-local" id="end-date" />
        </div>
        <div class="filter-actions">
          <button id="btn-generate-visual" class="btn-report">
            <span class="material-icons">visibility</span> Gerar Relatório
            Visual
          </button>
          <button id="btn-generate-pdf" class="btn-report pdf">
            <span class="material-icons">picture_as_pdf</span> Exportar PDF
          </button>
        </div>
      </div>

      <div id="report-container" style="display: none">
        <div class="report-header">
          <h2 id="report-title">Relatório de Monitoramento</h2>
          <p id="report-period">Período:</p>
        </div>

        <div class="stats-grid-report">
          <div class="stat-card-report">
            <h3>Temp. Mínima</h3>
            <p id="stat-min">-- °C</p>
          </div>
          <div class="stat-card-report">
            <h3>Temp. Média</h3>
            <p id="stat-avg">-- °C</p>
          </div>
          <div class="stat-card-report">
            <h3>Temp. Máxima</h3>
            <p id="stat-max">-- °C</p>
          </div>
        </div>

        <div class="chart-container-report">
          <h3>Histórico de Temperatura</h3>
          <canvas id="report-chart"></canvas>
        </div>

        <div class="table-container-report">
          <h3>Histórico de Acionamentos da Ventilação</h3>
          <table id="report-fan-table">
            <thead>
              <tr>
                <th>Início</th>
                <th>Fim</th>
                <th>Duração</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>

      <div id="loader-report" class="loader" style="display: none"></div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="/scripts/logbox/relatorios.js"></script>
  </body>
</html>
